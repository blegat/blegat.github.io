<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/highlight/styles/github.min.css"> <link rel=stylesheet  href="/css/judoc.css"> <link rel=stylesheet  href="/css/basic.css"> <link rel=stylesheet  href="/css/custom.css"> <link rel=icon  href="/assets/infra/favicon.ico"> <title>Lecture 7 &ndash; Traveling Salesman Problem</title> <header> <div class=blog-name ><a href="">Beno√Æt Legat</a></div> <nav> <ul> <li><a href="/">Home</a> <li><a href="/publications/">Publications</a> <li><a href="/talks/">Talks</a> <li><a href="/softwares/">Softwares</a> <li><a href="/teaching/">Teaching</a> </ul> <img src="/assets/infra/hamburger.svg" id=menu-icon > </nav> </header> <div class=franklin-content ><h1 id=lecture_7_ndash_traveling_salesman_problem ><a href="#lecture_7_ndash_traveling_salesman_problem" class=header-anchor >Lecture 7 &ndash; Traveling Salesman Problem</a></h1> <p> <a href="https://mybinder.org/v2/gh/blegat/blegat.github.io/gh-pages?filepath=/generated/notebooks/lecture7.ipynb"><span class=badge > <img src="https://mybinder.org/badge_logo.svg" alt="" /> </span></a> <a href="https://nbviewer.jupyter.org/github/blegat/blegat.github.io/blob/gh-pages//generated/notebooks/lecture7.ipynb"><span class=badge > <img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt="" /> </span></a> </p> <hr /> <h1 id=visualization ><a href="#visualization" class=header-anchor >Visualization</a></h1> <pre><code class="julia hljs">n = <span class=hljs-number >30</span>
<span class=hljs-keyword >using</span> Random
Random.seed!(<span class=hljs-number >1234</span>)
x = rand(n)
y = rand(n)

<span class=hljs-keyword >using</span> Plots
<span class=hljs-keyword >function</span> p(x, y, order)
    scatter(x, y, label=<span class=hljs-string >&quot;&quot;</span>)
    <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:n
        from = order[i]
        to = order[mod1(i + <span class=hljs-number >1</span>, n)]
        plot!([x[from], x[to]], [y[from], y[to]], label=<span class=hljs-string >&quot;&quot;</span>, color=:black)
    <span class=hljs-keyword >end</span>
    plot!()
<span class=hljs-keyword >end</span>

p(x, y, <span class=hljs-number >1</span>:<span class=hljs-number >12</span>)

norm([x[<span class=hljs-number >1</span>] - x[<span class=hljs-number >2</span>], y[<span class=hljs-number >1</span>] - y[<span class=hljs-number >2</span>]])

cost(x, y, <span class=hljs-number >1</span>:<span class=hljs-number >10</span>)

cost(x, y, [<span class=hljs-number >1</span>, <span class=hljs-number >4</span>, <span class=hljs-number >3</span>, <span class=hljs-number >2</span>, <span class=hljs-number >5</span>, <span class=hljs-number >9</span>, <span class=hljs-number >8</span>, <span class=hljs-number >6</span>, <span class=hljs-number >7</span>, <span class=hljs-number >10</span>])

p(x, y, [<span class=hljs-number >1</span>, <span class=hljs-number >4</span>, <span class=hljs-number >3</span>, <span class=hljs-number >2</span>, <span class=hljs-number >5</span>, <span class=hljs-number >9</span>, <span class=hljs-number >8</span>, <span class=hljs-number >6</span>, <span class=hljs-number >7</span>, <span class=hljs-number >10</span>])

<span class=hljs-keyword >using</span> LinearAlgebra
<span class=hljs-keyword >function</span> cost(x, y, order)
    n = length(x)
    s = <span class=hljs-number >0.0</span>
    <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:n
        from = order[i]
        to = order[mod1(i + <span class=hljs-number >1</span>, n)]
        s += norm([x[to] - x[from], y[to] - y[from]])
    <span class=hljs-keyword >end</span>
    <span class=hljs-keyword >return</span> s
<span class=hljs-keyword >end</span></code></pre> <h1 id=brute-force ><a href="#brute-force" class=header-anchor >Brute-Force</a></h1> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> Combinatorics
<span class=hljs-keyword >using</span> ProgressMeter
<span class=hljs-keyword >function</span> brute_force(x, y)
    n = length(x)
    best_order = <span class=hljs-literal >nothing</span>
    best_cost = <span class=hljs-literal >Inf</span>
    <span class=hljs-meta >@showprogress</span> <span class=hljs-keyword >for</span> order <span class=hljs-keyword >in</span> Combinatorics.permutations(<span class=hljs-number >1</span>:n)
        current_cost = cost(x, y, order)
        <span class=hljs-keyword >if</span> current_cost &lt; best_cost
            best_cost = current_cost
            best_order = order
        <span class=hljs-keyword >end</span>
    <span class=hljs-keyword >end</span>
    <span class=hljs-keyword >return</span> best_order
<span class=hljs-keyword >end</span>

best_order = <span class=hljs-meta >@time</span> brute_force(x, y)

cost(x, y, best_order)

p(x, y, best_order)

factorial(<span class=hljs-number >20</span>)</code></pre> <h1 id=mixed-integer_programming ><a href="#mixed-integer_programming" class=header-anchor >Mixed-Integer Programming</a></h1> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> JuMP
<span class=hljs-keyword >import</span> HiGHS
model = Model(HiGHS.Optimizer)
<span class=hljs-meta >@variable</span>(model, z[i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:n, j <span class=hljs-keyword >in</span> [<span class=hljs-number >1</span>:(i-<span class=hljs-number >1</span>); (i+<span class=hljs-number >1</span>):n]], Bin);

<span class=hljs-meta >@objective</span>(model, Min, sum(z[i, j] * norm([x[j] - x[i], y[j] - y[i]]) <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:n <span class=hljs-keyword >for</span> j <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:n <span class=hljs-keyword >if</span> i != j));

optimize!(model)

termination_status(model)

value.(z)

<span class=hljs-meta >@constraint</span>(model, one_incoming_edge[j <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:n], sum(z[i, j] <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:n <span class=hljs-keyword >if</span> i != j) == <span class=hljs-number >1</span>)

<span class=hljs-meta >@constraint</span>(model, one_outgoing_edge[i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:n], sum(z[i, j] <span class=hljs-keyword >for</span> j <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:n <span class=hljs-keyword >if</span> i != j) == <span class=hljs-number >1</span>)

optimize!(model)
solution_summary(model)

value.(z)

<span class=hljs-keyword >function</span> extract_order(x)
    next = zeros(<span class=hljs-built_in >Int</span>, n)
    <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:n
        <span class=hljs-keyword >for</span> j <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:n
            <span class=hljs-keyword >if</span> i != j &amp;&amp; isapprox(x[i, j], <span class=hljs-number >1</span>)
                <span class=hljs-keyword >if</span> !iszero(next[i])
                    error(<span class=hljs-string >&quot;Two edges outgoing from <span class=hljs-variable >$i</span>&quot;</span>)
                <span class=hljs-keyword >end</span>
                next[i] = j
            <span class=hljs-keyword >end</span>
        <span class=hljs-keyword >end</span>
    <span class=hljs-keyword >end</span>
    <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:n
        <span class=hljs-keyword >if</span> iszero(next[i])
            error(<span class=hljs-string >&quot;No outgoing edge from <span class=hljs-variable >$i</span>&quot;</span>)
        <span class=hljs-keyword >end</span>
    <span class=hljs-keyword >end</span>
    <span class=hljs-meta >@show</span> next
    orders = <span class=hljs-built_in >Vector</span>{<span class=hljs-built_in >Int</span>}[]
    visited = falses(n)
    <span class=hljs-keyword >for</span> start <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:n
        <span class=hljs-keyword >if</span> !visited[start]
            current = start
            order = <span class=hljs-built_in >Int</span>[]
            <span class=hljs-keyword >while</span> <span class=hljs-literal >true</span>
                visited[current] = <span class=hljs-literal >true</span>
                push!(order, current)
                current = next[current]
                <span class=hljs-keyword >if</span> current == start
                    <span class=hljs-keyword >break</span>
                <span class=hljs-keyword >end</span>
            <span class=hljs-keyword >end</span>
            push!(orders, order)
        <span class=hljs-keyword >end</span>
    <span class=hljs-keyword >end</span>
    <span class=hljs-keyword >return</span> orders
<span class=hljs-keyword >end</span>

mip_orders = extract_order(value.(z))

mip_order = reduce(vcat, mip_orders)

cost(x, y, mip_order)

p(x, y, mip_order)

<span class=hljs-meta >@constraint</span>(model, z[<span class=hljs-number >3</span>, <span class=hljs-number >10</span>] + z[<span class=hljs-number >10</span>, <span class=hljs-number >7</span>] + z[<span class=hljs-number >7</span>, <span class=hljs-number >8</span>] + z[<span class=hljs-number >8</span>, <span class=hljs-number >3</span>] &lt;= <span class=hljs-number >3</span>)

<span class=hljs-meta >@constraint</span>(model, [i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:n, j <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:n; i != j], z[i, j] + z[j, i] &lt;= <span class=hljs-number >1</span>)</code></pre> <h1 id=miller-tucker-zemlin ><a href="#miller-tucker-zemlin" class=header-anchor >Miller-Tucker-Zemlin</a></h1> <pre><code class="julia hljs"><span class=hljs-meta >@variable</span>(model, <span class=hljs-number >1</span> &lt;= place[<span class=hljs-number >1</span>:n] &lt;= n)</code></pre>
<p>if <code>z&#91;i, j&#93;</code> is 1 then <code>place&#91;i&#93; &gt;&#61; place&#91;j&#93; &#43; 1</code></p>
<pre><code class="julia hljs"><span class=hljs-meta >@constraint</span>(model, mtz[i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:n, j <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:n; i != j &amp;&amp; j != <span class=hljs-number >1</span>], n * (<span class=hljs-number >1</span> - z[i, j]) + place[i] &gt;= place[j] + <span class=hljs-number >1</span>)

optimize!(model)
solution_summary(model)

value.(place)

mip_orders = extract_order(value.(z))

mip_order = reduce(vcat, mip_orders)

cost(x, y, mip_order)

p(x, y, mip_order)

factorial(big(<span class=hljs-number >30</span>))</code></pre>
<hr />
<p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p>
<div class=page-foot >
  <div class=copyright >
    &copy; Beno√Æt Legat. Last modified: October 25, 2025. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a>.
  </div>
</div>
</div>
    
    
        <script src="/libs/highlight/highlight.min.js"></script>
<script>hljs.highlightAll();hljs.configure({tabReplace: '    '});</script>