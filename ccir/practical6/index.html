<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/highlight/styles/github.min.css"> <link rel=stylesheet  href="/css/judoc.css"> <link rel=stylesheet  href="/css/basic.css"> <link rel=stylesheet  href="/css/custom.css"> <link rel=icon  href="/assets/infra/favicon.ico"> <title>Practical 6 &ndash; Sudoku</title> <header> <div class=blog-name ><a href="">Benoît Legat</a></div> <nav> <ul> <li><a href="/">Home</a> <li><a href="/publications/">Publications</a> <li><a href="/talks/">Talks</a> <li><a href="/softwares/">Softwares</a> <li><a href="/teaching/">Teaching</a> </ul> <img src="/assets/infra/hamburger.svg" id=menu-icon > </nav> </header> <div class=franklin-content ><h1 id=practical_6_ndash_sudoku ><a href="#practical_6_ndash_sudoku" class=header-anchor >Practical 6 &ndash; Sudoku</a></h1> <p> <a href="https://mybinder.org/v2/gh/blegat/blegat.github.io/gh-pages?filepath=/generated/notebooks/practical6.ipynb"><span class=badge > <img src="https://mybinder.org/badge_logo.svg" alt="" /> </span></a> <a href="https://nbviewer.jupyter.org/github/blegat/blegat.github.io/blob/gh-pages//generated/notebooks/practical6.ipynb"><span class=badge > <img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt="" /> </span></a> </p> <hr /> <p>Inspired from <a href="https://jump.dev/JuMP.jl/v1.10.0/tutorials/linear/sudoku">a JuMP tutorial</a></p> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> JuMP
<span class=hljs-keyword >using</span> HiGHS</code></pre> <h1 id=sudoku ><a href="#sudoku" class=header-anchor >Sudoku</a></h1> <pre><code class="julia hljs">init_sol = [
    <span class=hljs-number >5</span> <span class=hljs-number >3</span> <span class=hljs-number >0</span> <span class=hljs-number >0</span> <span class=hljs-number >7</span> <span class=hljs-number >0</span> <span class=hljs-number >0</span> <span class=hljs-number >0</span> <span class=hljs-number >0</span>
    <span class=hljs-number >6</span> <span class=hljs-number >0</span> <span class=hljs-number >0</span> <span class=hljs-number >1</span> <span class=hljs-number >9</span> <span class=hljs-number >5</span> <span class=hljs-number >0</span> <span class=hljs-number >0</span> <span class=hljs-number >0</span>
    <span class=hljs-number >0</span> <span class=hljs-number >9</span> <span class=hljs-number >8</span> <span class=hljs-number >0</span> <span class=hljs-number >0</span> <span class=hljs-number >0</span> <span class=hljs-number >0</span> <span class=hljs-number >6</span> <span class=hljs-number >0</span>
    <span class=hljs-number >8</span> <span class=hljs-number >0</span> <span class=hljs-number >0</span> <span class=hljs-number >0</span> <span class=hljs-number >6</span> <span class=hljs-number >0</span> <span class=hljs-number >0</span> <span class=hljs-number >0</span> <span class=hljs-number >3</span>
    <span class=hljs-number >4</span> <span class=hljs-number >0</span> <span class=hljs-number >0</span> <span class=hljs-number >8</span> <span class=hljs-number >0</span> <span class=hljs-number >3</span> <span class=hljs-number >0</span> <span class=hljs-number >0</span> <span class=hljs-number >1</span>
    <span class=hljs-number >7</span> <span class=hljs-number >0</span> <span class=hljs-number >0</span> <span class=hljs-number >0</span> <span class=hljs-number >2</span> <span class=hljs-number >0</span> <span class=hljs-number >0</span> <span class=hljs-number >0</span> <span class=hljs-number >6</span>
    <span class=hljs-number >0</span> <span class=hljs-number >6</span> <span class=hljs-number >0</span> <span class=hljs-number >0</span> <span class=hljs-number >0</span> <span class=hljs-number >0</span> <span class=hljs-number >2</span> <span class=hljs-number >8</span> <span class=hljs-number >0</span>
    <span class=hljs-number >0</span> <span class=hljs-number >0</span> <span class=hljs-number >0</span> <span class=hljs-number >4</span> <span class=hljs-number >1</span> <span class=hljs-number >9</span> <span class=hljs-number >0</span> <span class=hljs-number >0</span> <span class=hljs-number >5</span>
    <span class=hljs-number >0</span> <span class=hljs-number >0</span> <span class=hljs-number >0</span> <span class=hljs-number >0</span> <span class=hljs-number >8</span> <span class=hljs-number >0</span> <span class=hljs-number >0</span> <span class=hljs-number >7</span> <span class=hljs-number >9</span>
]</code></pre> <h2 id=integer_variables ><a href="#integer_variables" class=header-anchor >Integer variables</a></h2> <pre><code class="julia hljs">model = Model(HiGHS.Optimizer)
<span class=hljs-meta >@variable</span>(model, <span class=hljs-number >1</span> &lt;= x[row <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >9</span>, col <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >9</span>] &lt;= <span class=hljs-number >9</span>, <span class=hljs-built_in >Int</span>)

optimize!(model)
termination_status(model)

solve_time(model)

value.(x)

<span class=hljs-keyword >for</span> row <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >9</span>
    <span class=hljs-keyword >for</span> col <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >9</span>
        value = init_sol[row, col]
        <span class=hljs-keyword >if</span> value != <span class=hljs-number >0</span>
            fix(x[row, col], value, force = <span class=hljs-literal >true</span>)
        <span class=hljs-keyword >end</span>
    <span class=hljs-keyword >end</span>
<span class=hljs-keyword >end</span>

<span class=hljs-meta >@variable</span>(model, which_one_should_be_satisfied, Bin)
<span class=hljs-meta >@constraint</span>(model, x[<span class=hljs-number >1</span>, <span class=hljs-number >3</span>] - x[<span class=hljs-number >1</span>, <span class=hljs-number >4</span>] &gt;= <span class=hljs-number >1</span> - (<span class=hljs-number >1</span> - which_one_should_be_satisfied) * <span class=hljs-number >10000000</span>)
<span class=hljs-meta >@constraint</span>(model, -(x[<span class=hljs-number >1</span>, <span class=hljs-number >3</span>] - x[<span class=hljs-number >1</span>, <span class=hljs-number >4</span>]) &gt;= <span class=hljs-number >1</span> - which_one_should_be_satisfied * <span class=hljs-number >10000000</span>)

<span class=hljs-keyword >function</span> constraint_alldifferent(x::<span class=hljs-built_in >Vector</span>)
    <span class=hljs-meta >@assert</span> length(x) == <span class=hljs-number >9</span>
    <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >9</span>
        <span class=hljs-keyword >for</span> j <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >9</span>
            <span class=hljs-keyword >if</span> i != j
                <span class=hljs-comment ># @constraint(model, abs(x[i] - x[j]) &gt;= 1)</span>
                positive = <span class=hljs-meta >@variable</span>(model, binary = <span class=hljs-literal >true</span>)
                <span class=hljs-comment ># @constraint(model, positive =&gt; {x[i] - x[j] &gt;= 1})</span>
                <span class=hljs-comment ># Big-M</span>
                M = <span class=hljs-number >9</span>
                <span class=hljs-meta >@constraint</span>(model, x[i] - x[j] &gt;= <span class=hljs-number >1</span> - M * (<span class=hljs-number >1</span> - positive))
                <span class=hljs-comment ># @constraint(model, !positive =&gt; {-(x[i] - x[j]) &gt;= 1})</span>
                <span class=hljs-meta >@constraint</span>(model, x[j] - x[i] &gt;= <span class=hljs-number >1</span> - M * positive)
            <span class=hljs-keyword >end</span>
        <span class=hljs-keyword >end</span>
    <span class=hljs-keyword >end</span>
<span class=hljs-keyword >end</span>

<span class=hljs-keyword >for</span> row <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >9</span>
    constraint_alldifferent(x[row, :])
<span class=hljs-keyword >end</span>

<span class=hljs-keyword >for</span> col <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >9</span>
    constraint_alldifferent(x[:, col])
<span class=hljs-keyword >end</span>

<span class=hljs-keyword >for</span> shift_row <span class=hljs-keyword >in</span> <span class=hljs-number >0</span>:<span class=hljs-number >3</span>:<span class=hljs-number >6</span>
    <span class=hljs-keyword >for</span> shift_col <span class=hljs-keyword >in</span> <span class=hljs-number >0</span>:<span class=hljs-number >3</span>:<span class=hljs-number >6</span>
        constraint_alldifferent(vec(x[shift_row .+ (<span class=hljs-number >1</span>:<span class=hljs-number >3</span>), shift_col .+ (<span class=hljs-number >1</span>:<span class=hljs-number >3</span>)]))
    <span class=hljs-keyword >end</span>
<span class=hljs-keyword >end</span>

num_variables(model)

optimize!(model)

solution_summary(model)

value.(x)</code></pre> <h1 id=with_binary_variables ><a href="#with_binary_variables" class=header-anchor >With Binary variables</a></h1> <pre><code class="julia hljs">model = Model(HiGHS.Optimizer)

<span class=hljs-meta >@variable</span>(model, y[row = <span class=hljs-number >1</span>:<span class=hljs-number >9</span>, col = <span class=hljs-number >1</span>:<span class=hljs-number >9</span>, num = <span class=hljs-number >1</span>:<span class=hljs-number >9</span>], Bin);

<span class=hljs-keyword >for</span> row <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >9</span>
    <span class=hljs-keyword >for</span> col <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >9</span>
        <span class=hljs-keyword >if</span> init_sol[row, col] != <span class=hljs-number >0</span>
            <span class=hljs-keyword >for</span> num <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >9</span>
                <span class=hljs-keyword >if</span> num == init_sol[row, col]
                    fix(y[row, col, num], <span class=hljs-number >1</span>, force = <span class=hljs-literal >true</span>)
                <span class=hljs-keyword >else</span>
                    fix(y[row, col, num], <span class=hljs-number >0</span>, force = <span class=hljs-literal >true</span>)
                <span class=hljs-keyword >end</span>
            <span class=hljs-keyword >end</span>
        <span class=hljs-keyword >end</span>
    <span class=hljs-keyword >end</span>
<span class=hljs-keyword >end</span>

<span class=hljs-meta >@constraint</span>(model, [row <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >9</span>, col <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >9</span>], sum(y[row, col, :]) == <span class=hljs-number >1</span>);

<span class=hljs-meta >@constraint</span>(model, [row <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >9</span>, num <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >9</span>], sum(y[row, :, num]) == <span class=hljs-number >1</span>);

<span class=hljs-meta >@constraint</span>(model, [col <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >9</span>, num <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >9</span>], sum(y[row, col, num] <span class=hljs-keyword >for</span> row <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >9</span>) == <span class=hljs-number >1</span>);

<span class=hljs-meta >@constraint</span>(
    model,
    [row_shift <span class=hljs-keyword >in</span> <span class=hljs-number >0</span>:<span class=hljs-number >3</span>:<span class=hljs-number >6</span>, col_shift <span class=hljs-keyword >in</span> <span class=hljs-number >0</span>:<span class=hljs-number >3</span>:<span class=hljs-number >6</span>, num <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >9</span>],
    sum(y[row_shift + row, col_shift + col, num] <span class=hljs-keyword >for</span> row <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >3</span>, col <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >3</span>) == <span class=hljs-number >1</span>,
);

optimize!(model)

solution_summary(model)

num_variables(model)

<span class=hljs-keyword >function</span> extract(x)
    nums = zeros(<span class=hljs-built_in >Int</span>, <span class=hljs-number >9</span>, <span class=hljs-number >9</span>)
    <span class=hljs-keyword >for</span> col <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >9</span>
        <span class=hljs-keyword >for</span> row <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >9</span>
            <span class=hljs-keyword >for</span> num <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >9</span>
                <span class=hljs-keyword >if</span> x[row, col, num] &gt; <span class=hljs-number >0.5</span>
                    <span class=hljs-keyword >if</span> nums[row, col] != <span class=hljs-number >0</span>
                        error(<span class=hljs-string >&quot;Cell (<span class=hljs-variable >$row</span>, <span class=hljs-variable >$col</span>) cannot be both <span class=hljs-subst >$(nums[row, col])</span> and <span class=hljs-variable >$num</span>&quot;</span>)
                    <span class=hljs-keyword >end</span>
                    nums[row, col] = num
                <span class=hljs-keyword >end</span>
            <span class=hljs-keyword >end</span>
        <span class=hljs-keyword >end</span>
    <span class=hljs-keyword >end</span>
    <span class=hljs-keyword >return</span> nums
<span class=hljs-keyword >end</span>

extract(value.(y))</code></pre> <hr /> <p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p> <div class=page-foot > <div class=copyright > &copy; Benoît Legat. Last modified: November 17, 2025. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a>. </div> </div> </div> <script src="/libs/highlight/highlight.min.js"></script> <script>hljs.highlightAll();hljs.configure({tabReplace: ' '});</script>